(this.webpackJsonplc_podcast=this.webpackJsonplc_podcast||[]).push([[0],{43:function(e,t,n){},53:function(e,t,n){e.exports=n(68)},58:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(25),l=n.n(i),o=(n(58),n(13)),s=n(14),c=n(16),u=n(15),d=n(8),m=n(6),p=n(27),h=n.n(p),f=n(29),v=n(9),w=n.n(v),_=n(70);function g(){var e=Object(d.a)(["\n  mutation LoginMutation($email: String!, $password: String!) {\n    Login(email: $email, password: $password) {\n      _id\n      user_name\n      password\n      token\n      role\n    }\n  }\n"]);return g=function(){return e},e}function x(){var e=Object(d.a)(["\n  mutation UpgradeMutation($email: String!, $password: String!, $user_name: String!, $userId: Int!) {\n    UpgradeUser(email: $email, password: $password, user_name: $user_name, userId: $userId) {\n      _id\n      user_name\n      password\n      token\n      role\n    }\n  }\n"]);return x=function(){return e},e}function E(){var e=Object(d.a)(["\n  mutation SignupMutation($email: String!, $password: String!, $user_name: String!) {\n    CreateUser(email: $email, password: $password, user_name: $user_name) {\n      _id\n      user_name\n      password\n      token\n      role\n    }\n  }\n"]);return E=function(){return e},e}var S=w()(E()),y=w()(x()),b=w()(g()),T=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={isLogin:!0,email:"",password:"",user_name:"",userId:null,role:"TESTER"},e._confirm=function(){var t=Object(f.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.props.history.push("/"),window.location.reload(!0);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){if(this.props.user){var e=this.props.user,t=e.user_name,n=e._id,a=e.role;this.setUserInfo(t,parseInt(n),a)}}},{key:"setUserInfo",value:function(e,t,n){this.setState({user_name:e,userId:t,role:n})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isLogin,a=t.email,i=t.password,l=t.user_name,o=t.userId,s=t.role;return r.a.createElement("div",null,r.a.createElement("h4",null,n?"Login":"Sign Up"),r.a.createElement("div",{className:"flex flex-column"},!n&&r.a.createElement("input",{value:l,onChange:function(t){return e.setState({user_name:t.target.value})},type:"text",placeholder:"Your name"}),r.a.createElement("input",{value:a,onChange:function(t){return e.setState({email:t.target.value})},type:"text",placeholder:"Your email address"}),r.a.createElement("input",{value:i,onChange:function(t){return e.setState({password:t.target.value})},type:"password",placeholder:"Choose a safe password"})),r.a.createElement("div",null,r.a.createElement(_.a,{mutation:n?b:"TESTER"===s?y:S,variables:{email:a,password:i,user_name:l,userId:o},onCompleted:function(t){return e._confirm(t)}},(function(e){return r.a.createElement("button",{type:"button",onClick:e},n?"login":"create account")})),r.a.createElement("button",{type:"button",onClick:function(){return e.setState({isLogin:!e.state.isLogin})}},n?"need to create an account?":"already have an account?")))}}]),n}(a.Component),C=Object(m.f)(T),I=n(21),$=function(e){for(var t=e+"=",n=decodeURIComponent(document.cookie).split(";"),a=0;a<n.length;a++){for(var r=n[a];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return""},k=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=!!$("access-token");return r.a.createElement("div",null,r.a.createElement("div",null,"Chinese App"),r.a.createElement(I.b,{to:"/"},"play"),r.a.createElement("div",null,t&&this.props.user&&"ADMIN"===this.props.user.role&&r.a.createElement("div",null,r.a.createElement("div",{className:"flex"},r.a.createElement(I.b,{to:"/author"},"author")),r.a.createElement("div",{className:"flex"},r.a.createElement(I.b,{to:"/editor"},"editor")),r.a.createElement("div",{className:"flex"},r.a.createElement(I.b,{to:"/words"},"words")))),r.a.createElement("div",{className:"flex flex-fixed"},t&&this.props.user&&"TESTER"!==this.props.user.role?r.a.createElement("div",{onClick:function(){document.cookie="access-token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",document.cookie="refresh-token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",e.props.history.push("/"),window.location.reload(!0)}},"logout"):r.a.createElement(I.b,{to:"/login"},"login")))}}]),n}(a.Component),O=Object(m.f)(k),A=n(32),j=n(39),N=(n(43),[{id:1,text:"\uff0c",type:"COMMA"},{id:2,text:"\u3002",type:"PERIOD"},{id:3,text:"\u201d",type:"QUOTE"},{id:4,text:"\uff01",type:"EXCLAMATION"},{id:5,text:"\uff1f",type:"QUESTION"},{id:6,text:"\uff1a",type:"COLON"},{id:7,text:"0",type:"ZERO"},{id:8,text:"1",type:"ONE"},{id:9,text:"2",type:"TWO"},{id:10,text:"3",type:"THREE"},{id:11,text:"4",type:"FOUR"},{id:12,text:"5",type:"FIVE"},{id:13,text:"6",type:"SIX"},{id:14,text:"7",type:"SEVEN"},{id:15,text:"8",type:"EIGHT"},{id:16,text:"9",type:"NINE"},{id:17,text:" ",type:"SPACE"},{id:18,text:"Smith",type:"NAME"}]),W=[{times_used:0,color:"lightblue"},{times_used:1,color:"pink"},{times_used:2,color:"yellow"},{times_used:3,color:"lightgreen"},{times_used:4,color:"coral"},{times_used:5,color:"blueviolet"}],D=(n(66),function(e){var t=e.isOn,n=e.handleToggle;return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{checked:t,onChange:n,className:"react-switch-checkbox",id:"react-switch-new",type:"checkbox"}),r.a.createElement("label",{style:{background:t&&"#06D6A0"},className:"react-switch-label",htmlFor:"react-switch-new"},r.a.createElement("span",{className:"react-switch-button"})))}),L=n(38);function M(){var e=Object(d.a)(["\n  mutation replacesentence($rawSentenceTextSimplified: String!, $cleanSentenceTextSimplified: String!, $displaySentenceTextSimplified: String!,$rawSentenceTextTraditional: String!, $cleanSentenceTextTraditional: String!, $displaySentenceTextTraditional: String!, $pinyin: String!, $english: String!, $italics: String! $wordToTeachId: Int!, $sentenceContainedWordListSimplified: [String!], $currentInterval: Int!, $formerSentenceRawText: String!) {\n    DeleteSentence(raw_text: $formerSentenceRawText){\n      raw_text\n    }\n    CreateSentence(raw_text: $rawSentenceTextSimplified, clean_text: $cleanSentenceTextSimplified, display_text: $displaySentenceTextSimplified, alt_raw_text: $rawSentenceTextTraditional, alt_clean_text: $cleanSentenceTextTraditional, alt_display_text: $displaySentenceTextTraditional, pinyin: $pinyin, english: $english,, italics: $italics) {\n      raw_text\n    }\n    AddSentenceLevel(from: {raw_text:  $rawSentenceTextSimplified} to: {level_number: 1}){\n      from {raw_text}\n      to {level_number}\n    }\n    AddSentenceWord_taught(from: {raw_text: $rawSentenceTextSimplified} to: {word_id: $wordToTeachId}){\n      from {raw_text}\n      to {text}\n    }\n    AddSentenceInterval(from: {raw_text: $rawSentenceTextSimplified} to: {interval_order: $currentInterval}){\n      from {raw_text}\n      to {interval_order}\n    }\n    AddSentenceDependencies(src_sentence: $rawSentenceTextSimplified, dest_words: $sentenceContainedWordListSimplified){\n      raw_text\n      display_text\n    }\n  }\n\n"]);return M=function(){return e},e}function R(){var e=Object(d.a)(["\n  mutation addsentence($rawSentenceTextSimplified: String!, $cleanSentenceTextSimplified: String!, $displaySentenceTextSimplified: String!,$rawSentenceTextTraditional: String!, $cleanSentenceTextTraditional: String!, $displaySentenceTextTraditional: String!, $pinyin: String!, $english: String!, $italics: String!, $wordToTeachId: Int!, $sentenceContainedWordListSimplified: [String!], $currentInterval: Int!, $shouldCall: Boolean!) {\n    CreateSentence(raw_text: $rawSentenceTextSimplified, clean_text: $cleanSentenceTextSimplified, display_text: $displaySentenceTextSimplified, alt_raw_text: $rawSentenceTextTraditional, alt_clean_text: $cleanSentenceTextTraditional, alt_display_text: $displaySentenceTextTraditional, pinyin: $pinyin, english: $english, italics: $italics) {\n      raw_text\n    }\n    AddSentenceLevel(from: {raw_text:  $rawSentenceTextSimplified} to: {level_number: 1}){\n      from {raw_text}\n      to {level_number}\n    }\n    AddSentenceWord_taught(from: {raw_text: $rawSentenceTextSimplified} to: {word_id: $wordToTeachId}){\n      from {raw_text}\n      to {text}\n    }\n    AddSentenceInterval(from: {raw_text: $rawSentenceTextSimplified} to: {interval_order: $currentInterval}){\n      from {raw_text}\n      to {interval_order}\n    }\n    AddSentenceDependencies(src_sentence: $rawSentenceTextSimplified, dest_words: $sentenceContainedWordListSimplified){\n      raw_text\n      display_text\n    }\n    IncrementInterval(should_call: $shouldCall)\n  }\n\n"]);return R=function(){return e},e}function U(){var e=Object(d.a)(["\n  query GetLevelWords{\n  Author{\n    level{\n      level_number\n      points\n      minimum_usage\n      teachable_words{\n        text\n        alt_text\n        word_id\n        level{\n          points\n        }\n      }\n      addable_words{\n        text\n        alt_text\n        word_id\n        times_used\n        level{\n          points\n        }\n      }\n    }\n    interval{\n      sentences{\n        clean_text\n      }\n      interval_order\n      seconds\n      min_length\n      max_length\n    }\n  }\n}\n"]);return U=function(){return e},e}var P=w()(U()),F=w()(R()),q=w()(M()),z={option:function(e,t){var n=t.data;return Object(j.a)(Object(j.a)({},e),{},{color:"black",backgroundColor:n.color})}},B=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).baseState={SentenceElements:[],formerSentenceRawText:null,formerSentenceCleanText:null,selectedWordId:null,wordToTeach:{text:"",word_id:null},containsWordToTeach:0,points:0,punctuationMode:!1,selectedPunctuationId:null,pinyin:"",english:"",italics:"",replaceMode:!1,interval:null},"undefined"===typeof e.location.state?a.state=a.baseState:a.state={SentenceElements:e.location.state.sentenceElements,formerSentenceRawText:e.location.state.formerSentenceRawText,formerSentenceCleanText:e.location.state.formerSentenceCleanText,selectedWordId:null,wordToTeach:e.location.state.wordToTeach,containsWordToTeach:e.location.state.containsWordToTeach,points:e.location.state.points,punctuationMode:!1,selectedPunctuationId:null,pinyin:e.location.state.pinyin,english:e.location.state.english,italics:e.location.state.italics,interval:e.location.state.interval,replaceMode:!0},a}return Object(s.a)(n,[{key:"get_word_array",value:function(e,t){var n=this.state.wordToTeach;return n&&n.text.length&&1===t?[n].concat(Object(A.a)(e.addable_words)):n&&n.text.length&&t>1?e.addable_words:e.teachable_words}},{key:"submitSentenceData",value:function(e,t,n,a){var r=this.state.SentenceElements,i=r.filter((function(e){return e.hasOwnProperty("word_id")})),l=i.map((function(e){return e.text})),o=l.join("");e.includes(o)&&o!==this.state.formerSentenceCleanText?alert("Already used this sentence. Please change it."):a({variables:this.getSentenceVariables(r,i,l,o,t,n)})}},{key:"getSentenceVariables",value:function(e,t,n,a,r,i){var l=this.state,o=l.wordToTeach,s=l.pinyin,c=l.english,u=l.italics,d=l.formerSentenceRawText,m=l.replaceMode,p=n.filter((function(e){return e!==o.text})),h=e.map((function(e){return e.text})).join(""),f=h.replace(new RegExp(o.text,"g"),"#"),v=t.map((function(e){return e.alt_text})).join(""),w=e.map((function(e){return e.alt_text||e.text})).join(""),_=w.replace(new RegExp(o.alt_text,"g"),"#"),g=1===i&&r<5,x={rawSentenceTextSimplified:h,cleanSentenceTextSimplified:a,displaySentenceTextSimplified:f,rawSentenceTextTraditional:w,cleanSentenceTextTraditional:v,displaySentenceTextTraditional:_,pinyin:s,english:c,italics:u,wordToTeachText:o.text,wordToTeachId:o.word_id,sentenceContainedWordListSimplified:p,currentInterval:r};return m?Object.assign(x,{formerSentenceRawText:d}):Object.assign(x,{shouldCall:g}),x}},{key:"appendElement",value:function(e){var t=this;e.hasOwnProperty("word_id")?this.setState((function(n){return{points:n.points+e.level.points,containsWordToTeach:e.word_id===t.state.wordToTeach.word_id?n.containsWordToTeach+1:n.containsWordToTeach,SentenceElements:[].concat(Object(A.a)(n.SentenceElements),[e])}})):this.setState((function(t){return{SentenceElements:[].concat(Object(A.a)(t.SentenceElements),[e])}}))}},{key:"popElement",value:function(){var e=this;this.state.SentenceElements[this.state.SentenceElements.length-1].hasOwnProperty("word_id")?this.setState((function(t){return{points:t.points-t.SentenceElements[t.SentenceElements.length-1].level.points,containsWordToTeach:t.SentenceElements[t.SentenceElements.length-1].word_id===e.state.wordToTeach.word_id?t.containsWordToTeach-1:t.containsWordToTeach,SentenceElements:t.SentenceElements.slice(0,-1)}})):this.setState((function(e){return{SentenceElements:e.SentenceElements.slice(0,-1)}}))}},{key:"getColor",value:function(e,t){var n="white",a=t+5;return e.hasOwnProperty("times_used")&&(n=W.find((function(n){return n.times_used+t===parseInt(e.times_used)||5===n.times_used&&parseInt(e.times_used)>=a})).color),n}},{key:"render",value:function(){var e=this,t=this.state,n=t.SentenceElements,a=t.wordToTeach,i=t.points,l=t.selectedWordId,o=t.containsWordToTeach,s=t.punctuationMode,c=t.selectedPunctuationId;return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(_.b,{query:P},(function(t){var u=t.loading,d=t.error,m=t.data,p=t.refetch;if(u)return r.a.createElement("div",null,"Fetching");if(d)return r.a.createElement("div",null,"Error");var h=e.state.interval||m.Author[0].interval,f=e.get_word_array(m.Author[0].level,h.interval_order),v=parseInt(m.Author[0].level.minimum_usage);return r.a.createElement("div",null,r.a.createElement("div",{className:"Author-dashboard"},r.a.createElement("p",null,"Interval: "+h.interval_order),r.a.createElement("p",null,"Minimum points: "+h.min_length),r.a.createElement("p",null,"Maximum points:: "+h.max_length),r.a.createElement("p",null,"Current Points: "+i)),r.a.createElement("p",null,"Word being learned: ",a.text),r.a.createElement("div",null,r.a.createElement("p",{style:{fontSize:"30px"}},n.length?n.map((function(e){return e.text})).join(""):null),r.a.createElement("button",{onClick:e.popElement.bind(e),hidden:0===n.length},"Backspace")),r.a.createElement(D,{isOn:s,handleToggle:function(){return e.setState((function(e){return{punctuationMode:!e.punctuationMode}}))}}),s?r.a.createElement("div",null,r.a.createElement(L.a,{styles:z,value:{value:c,label:c&&N.find((function(e){return e.id===c})).text},options:N.map((function(e){return{label:e.text,value:e.id}})),onChange:function(t){return e.setState({selectedPunctuationId:parseInt(t.value)})}}),r.a.createElement("button",{onClick:function(){return e.appendElement(N.find((function(e){return e.id===c})))}},"Add")):r.a.createElement("div",null,r.a.createElement(L.a,{styles:z,value:{value:l,label:l&&f.find((function(e){return e.word_id===l})).text},options:f.map((function(t){return{label:t.text,value:t.word_id,color:e.getColor(t,v)}})),onChange:function(t){return e.setState({selectedWordId:parseInt(t.value)})}}),r.a.createElement("button",{onClick:a.text.length?function(){return e.appendElement(f.find((function(e){return e.word_id===l})))}:function(){e.setState({wordToTeach:f.find((function(e){return e.word_id===l}))})}},a.text.length?"Add":"Learn")),r.a.createElement("div",null,r.a.createElement("input",{value:e.state.pinyin,onChange:function(t){return e.setState({pinyin:t.target.value})},type:"pinyin",placeholder:"Enter sentence's pinyin",style:{width:"250px"}})),r.a.createElement("div",null,r.a.createElement("input",{value:e.state.english,onChange:function(t){return e.setState({english:t.target.value})},type:"english",placeholder:"Enter sentence's english translation",style:{width:"250px"}})),r.a.createElement("div",null,r.a.createElement("input",{value:e.state.italics,onChange:function(t){return e.setState({italics:t.target.value})},type:"italics",placeholder:"Enter sentence's extra notes",style:{width:"250px"}})),r.a.createElement(_.a,{mutation:e.state.replaceMode?q:F,update:function(t){e.setState(e.baseState),p()}},(function(t){return r.a.createElement("button",{onClick:function(){e.submitSentenceData(h.sentences.map((function(e){return e.clean_text})),h.interval_order,m.Author[0].level.teachable_words.length,t)},disabled:!o},"Submit")})),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.setState(e.baseState)}},"Clear Sentence")))}))))}}]),n}(a.Component);function J(){var e=Object(d.a)(["\n  query getSentences($levelNumber: Int! $intervalOrder: Int!) {\n\tgetSentenceList(levelNumber: $levelNumber intervalOrder: $intervalOrder) {\n\t\traw_text\n\t\tclean_text\n\t\twords_contained{\n\t\t\tcontains_order\n\t\t\tWord{\n\t\t\t\tword_id\n\t\t\t\ttext\n\t\t\t\talt_text\n\t\t\t\tlevel{\n\t\t\t\t\tpoints\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdisplay_text\n\t\tword_taught{\n\t\t\tword_id\n\t\t\ttext\n\t\t\talt_text\n\t\t\tlevel{\n\t\t\t\tpoints\n\t\t\t}\n\t\t}\n\t\tpinyin\n\t\tenglish\n\t\titalics\n\t\tinterval{\n\t        sentences{\n\t          clean_text\n\t        }\n\t\t\tinterval_order\n      \t\tseconds\n      \t\tmin_length\n      \t\tmax_length\n\t\t}\n\t}\n  }\n"]);return J=function(){return e},e}function V(){var e=Object(d.a)(["\n  query getDropdowns($userName: String!) {\n\tgetIntervalsAndLevels(userName: $userName) {\n\t\tlevels\n\t\tintervals\n\t}\n  }\n"]);return V=function(){return e},e}var G=w()(V()),H=w()(J()),Y=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={selectedLevel:1,selectedInterval:1},e}return Object(s.a)(n,[{key:"getDropdowns",value:function(e){var t=this;return r.a.createElement(_.b,{query:G,variables:{userName:"test"}},(function(e){var n=e.loading,a=e.error,i=e.data;e.refetch;return n?r.a.createElement("div",null,"Fetching"):a?r.a.createElement("div",null,"Error"):r.a.createElement("div",null,"Level: ",r.a.createElement("select",{onChange:function(e){return t.setState({selectedLevel:parseInt(e.target.value)})}},i.getIntervalsAndLevels.levels.map((function(e){return r.a.createElement("option",{value:e,selected:e===t.state.selectedLevel},e)}))),"Interval: ",r.a.createElement("select",{onChange:function(e){return t.setState({selectedInterval:parseInt(e.target.value)})}},i.getIntervalsAndLevels.intervals.map((function(e){return r.a.createElement("option",{value:e,selected:e===t.state.selectedInterval},e)}))))}))}},{key:"parseSentence",value:function(e){var t=0,n=[],a=null,r=0,i=0,l=e.display_text;for(console.log(e),e.words_contained.sort((function(e,t){return e.contains_order-t.contains_order}));l.length;)"#"===l[0]?(n.push({text:e.word_taught.text,alt_text:e.word_taught.alt_text,word_id:e.word_taught.word_id,level:{points:e.word_taught.level.points}}),null===a&&(a={text:e.word_taught.text,alt_text:e.word_taught.alt_text,word_id:e.word_taught.word_id,level:{points:e.word_taught.level.points}}),l=l.substring(1),r++,i+=e.word_taught.level.points):e.words_contained[t]&&e.words_contained[t].Word.text[0]===l[0]?(console.log(e),n.push({text:e.words_contained[t].Word.text,alt_text:e.words_contained[t].Word.alt_text,word_id:e.words_contained[t].Word.word_id,level:{points:e.words_contained[t].Word.level.points}}),l=l.substring(e.words_contained[t].Word.text.length),i+=e.words_contained[t].Word.level.points,t++):(n.push({text:l[0]}),l=l.substring(1));this.props.history.push({pathname:"/author",state:{sentenceElements:n,formerSentenceRawText:e.raw_text,formerSentenceCleanText:e.clean_text,wordToTeach:a,containsWordToTeach:r,pinyin:e.pinyin,english:e.english,italics:e.italics,points:i,interval:e.interval}})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(_.b,{query:H,variables:{levelNumber:this.state.selectedLevel,intervalOrder:this.state.selectedInterval}},(function(t){var n=t.loading,a=t.error,i=t.data;t.refetch;return n?r.a.createElement("div",null,"Fetching"):a?r.a.createElement("div",null,"Error"):r.a.createElement("div",null,e.getDropdowns(),r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Sentence"),r.a.createElement("th",null,"Word Taught"),r.a.createElement("th",null,"Pinyin"),r.a.createElement("th",null,"Translation"),r.a.createElement("th",null,"Notes"))),r.a.createElement("tbody",null,i.getSentenceList.map((function(t){return r.a.createElement("tr",null,r.a.createElement("td",null,t.raw_text),r.a.createElement("td",null,t.word_taught.text),r.a.createElement("td",null,t.pinyin),r.a.createElement("td",null,t.english),r.a.createElement("td",null,t.italics),r.a.createElement("td",null,r.a.createElement("button",{onClick:function(){return e.parseSentence(t)}},"Edit")))})))))}))))}}]),n}(a.Component);function Q(){var e=Object(d.a)(["\n  query getWords {\n\tLevel {\n\t\tall_words{\n\t\t\tword_id\n\t\t\ttext\n\t\t\tpinyin\n\t\t\tenglish\n\t\t\titalics\n\t\t\ttimes_used\n\t\t\tlevel{\n\t\t\t\tlevel_number\n\t\t\t}\n\t\t}\n\t}\n  }\n"]);return Q=function(){return e},e}var X=w()(Q()),K=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"editWord",value:function(e){this.props.history.push({pathname:"/wordedit",state:{word_id:e.word_id,text:e.text,pinyin:e.pinyin,english:e.english,italics:e.italics}})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(_.b,{query:X},(function(t){var n=t.loading,a=t.error,i=t.data;t.refetch;if(n)return r.a.createElement("div",null,"Fetching");if(a)return r.a.createElement("div",null,"error");var l=i.Level[0].all_words;return r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Word"),r.a.createElement("th",null,"Pinyin"),r.a.createElement("th",null,"Translation"),r.a.createElement("th",null,"Notes"),r.a.createElement("th",null,"Times Used"),r.a.createElement("th",null,"Level"))),r.a.createElement("tbody",null,l.map((function(t){return r.a.createElement("tr",null,r.a.createElement("td",null,t.text),r.a.createElement("td",null,t.pinyin),r.a.createElement("td",null,t.english),r.a.createElement("td",null,t.italics),r.a.createElement("td",null,t.times_used),r.a.createElement("td",null,t.level?t.level.level_number:0),r.a.createElement("td",null,r.a.createElement("button",{onClick:function(){return e.editWord(t)}},"Edit")))}))))}))))}}]),n}(a.Component);function Z(){var e=Object(d.a)(["\n  mutation editWord($word_id: Int!, $english: String, $italics: String) {\n  \tUpdateWord(word_id: $word_id, english: $english, italics: $italics){\n  \t\tword_id\n  \t\ttext\n  \t}\n  }\n"]);return Z=function(){return e},e}var ee=w()(Z()),te=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={word_id:e.location.state.word_id,text:e.location.state.text,pinyin:e.location.state.pinyin,english:e.location.state.english,italics:e.location.state.italics},a}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("p",null,this.state.text),r.a.createElement("p",null,this.state.pinyin),r.a.createElement("p",null,"Translation"),r.a.createElement("input",{value:this.state.english,onChange:function(t){return e.setState({english:t.target.value})},type:"english",placeholder:"Enter word's english translation",style:{width:"250px"}}),r.a.createElement("p",null,"Notes"),r.a.createElement("input",{value:this.state.italics,onChange:function(t){return e.setState({italics:t.target.value})},type:"italics",placeholder:"Enter word's extra notes",style:{width:"250px"}}),r.a.createElement(_.a,{mutation:ee,update:function(t){e.props.history.push({pathname:"/words"})}},(function(t){return r.a.createElement("button",{onClick:function(){return t({variables:{word_id:parseInt(e.state.word_id),english:e.state.english,italics:e.state.italics}})},disabled:0===e.state.english.length},"Submit")}))))}}]),n}(a.Component),ne=n(50),ae=function(e){var t=e.bgcolor,n=e.completed,a={height:"100%",width:"".concat(n,"%"),backgroundColor:t,borderRadius:"inherit",textAlign:"right"};return r.a.createElement("div",{style:{height:20,width:"100%",backgroundColor:"#e0e0de"}},r.a.createElement("div",{style:a}))},re=(n(67),function(e){var t=e.handleClose,n=e.show,a=e.characters,i=n?"modal display-block":"modal display-none";return r.a.createElement("div",{className:i},r.a.createElement("section",{className:"modal-main"},a.map((function(e){return r.a.createElement("div",null,r.a.createElement("p",null,e.text),r.a.createElement("p",null,e.english))})),r.a.createElement("button",{onClick:t},"close")))});function ie(){var e=Object(d.a)(["\n  query getSentence($userId: Int!) {\n\tgetNextConnectedSentence(userId: $userId) {\n\t\t_id\n    time_fetched\n\t\tnext_interval_sentence_id\n\t\traw_text\n\t\tdisplay_text\n    clean_text\n\t\tpinyin\n\t\tenglish\n    italics\n    interval{\n      interval_order\n    }\n\t\tword_taught{\n      word_id\n\t\t\ttext\n\t\t\tenglish\n      pinyin\n\t\t\tcharacters{\n\t\t\t\ttext\n\t\t\t\tenglish\n\t\t\t}\n\t\t}\n\n\t}\n  getNextNewSentence(userId: $userId) {\n    _id\n    time_fetched\n    next_interval_sentence_id\n    raw_text\n    display_text\n    clean_text\n    pinyin\n    english\n    italics\n    interval{\n      interval_order\n    }\n    word_taught{\n      word_id\n      text\n      english\n      pinyin\n      characters{\n        text\n        english\n      }\n    }\n\n  }\n  getCurrentProgress(userId: $userId){\n    words_learned\n    intervals_completed\n    total_word_count\n  }\n\n  }\n\n"]);return ie=function(){return e},e}function le(){var e=Object(d.a)(["\nmutation addTemporaryUser($user_name: String!, $email: String!, $password: String!, $role: String!) {\n  CreateUser(user_name: $user_name, email: $email, password: $password, role: $role) {\n    _id\n    user_name\n    role\n    token\n  }\n}\n\n"]);return le=function(){return e},e}function oe(){var e=Object(d.a)(["\n  mutation makeAttempt($userId: Int!, $sentenceId: Int!, $isCorrect: Boolean!, $nextIntervalSentenceId: Int) {\n\tmakeClozeAttempt(userId: $userId, sentenceId: $sentenceId, isCorrect: $isCorrect, nextIntervalSentenceId: $nextIntervalSentenceId)\n  }\n\n"]);return oe=function(){return e},e}var se=w()(oe()),ce=w()(le()),ue=w()(ie()),de=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).showModal=function(){e.setState({showCharacterDefinitions:!0})},e.hideModal=function(){e.setState({showCharacterDefinitions:!1})},e._confirm=function(){var t=Object(f.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.props.refetchUser();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={showAnswer:!1,isSubmitted:!1,showCharacterDefinitions:!1,userResponse:"",isCorrect:!0,lastSentenceId:null,audio:null,timeFetched:null,user:{user_name:null,userId:null,role:null}},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){if(this.props.user){var e=this.props.user,t=e.user_name,n=e._id,a=e.role;this.setUserInfo(t,parseInt(n),a)}}},{key:"setUserInfo",value:function(e,t,n){this.setState({user:{user_name:e,userId:t,role:n}})}},{key:"componentDidUpdate",value:function(e){if(e.user&&this.props.user&&this.props.user._id===e.user._id&&this.props.user.role===e.user.role);else if(this.props.user){var t=this.props.user,n=t.user_name,a=t._id,r=t.role;this.setUserInfo(n,parseInt(a),r)}else e.user&&!this.props.user&&this.setUserInfo(null,null,null)}},{key:"checkAnswer",value:function(e){return e===this.state.userResponse}},{key:"setAudio",value:function(e){return new ne.Howl({src:["/audio/sentences/"+e+".m4a"]})}},{key:"playSound",value:function(){this.state.audio&&this.state.audio.play()}},{key:"getFontColor",value:function(){var e="black";return this.state.isSubmitted&&(e=this.state.isCorrect?"green":"red"),e}},{key:"submitAnswer",value:function(e,t,n,a,r,i,l,o){var s=this;this.state.isSubmitted?this.state.isSubmitted&&this.state.showAnswer?this.setState({showAnswer:!1,isSubmitted:!1,userResponse:"",timeFetched:i,showCharacterDefinitions:!1,audio:null},(function(){t()})):this.setState({showAnswer:!0,userResponse:r,isCorrect:!0},(function(){s.playSound()})):e({variables:{userId:n,sentenceId:a,isCorrect:l,nextIntervalSentenceId:o}})}},{key:"getText",value:function(e){return r.a.createElement("div",{style:{display:"flex",flexDirectioion:"row",justifyContent:"center"}},r.a.createElement("p",{style:{fontSize:"16px"}},e.english)," ",r.a.createElement("i",{style:{marginBlockStart:"1em"}},e.italics))}},{key:"playDashboard",value:function(e,t){var n=this;return r.a.createElement(_.b,{query:ue,variables:{userId:e}},(function(a){var i=a.loading,l=a.error,o=a.data,s=a.refetch;if(i)return r.a.createElement("div",null,"Fetching");if(l)return r.a.createElement("div",null,"error");console.log(o);var c=o.getNextConnectedSentence||o.getNextNewSentence;if(c&&n.state.timeFetched===c.time_fetched)return r.a.createElement("div",null);if(c){var u=parseInt(c._id),d=null;return e&&c.next_interval_sentence_id&&(d=c.next_interval_sentence_id),r.a.createElement("div",{style:{width:"50%"}},"TESTER"===t&&r.a.createElement("p",{style:{fontSize:"16px"}},"You are currently not logged in. Log in to save your progress."),r.a.createElement("p",null,"Words Learned: "+o.getCurrentProgress.words_learned+"/"+o.getCurrentProgress.total_word_count),r.a.createElement("p",null,"Cards Completed: "+o.getCurrentProgress.intervals_completed),r.a.createElement(ae,{bgcolor:"rgb(245 109 109)",completed:o.getCurrentProgress.intervals_completed/(7*o.getCurrentProgress.total_word_count)*100}),r.a.createElement("div",null,n.state.showAnswer&&r.a.createElement("button",{onClick:function(){return n.playSound(c._id,c.word_taught.word_id)}},"replay audio"),r.a.createElement(re,{characters:c.word_taught.characters,show:n.state.showCharacterDefinitions,handleClose:n.hideModal}),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"}},n.state.showAnswer&&r.a.createElement("p",{style:{fontSize:"16px"}},c.pinyin),n.getText(c)),r.a.createElement(_.a,{mutation:se,update:function(e){n.state.isSubmitted||n.setState({isSubmitted:!0,showAnswer:n.checkAnswer(c.word_taught.text),isCorrect:n.checkAnswer(c.word_taught.text),audio:n.setAudio(c._id)},(function(){n.checkAnswer(c.word_taught.text)&&n.playSound()}))}},(function(t){return r.a.createElement("div",{style:{display:"flex",flexDirectioion:"row",justifyContent:"center"}},r.a.createElement("p",null,c.display_text.substr(0,c.display_text.indexOf("#"))),r.a.createElement("input",{style:{width:"".concat(25*c.word_taught.text.length,"px"),fontSize:"calc(10px + 2vmin)",margin:"15px 5px 15px 5px",color:n.getFontColor()},value:n.state.userResponse,onChange:function(e){return n.setState({userResponse:e.target.value})},onKeyDown:function(a){"Enter"===a.key&&n.submitAnswer(t,s,e,u,c.word_taught.text,c.time_fetched,n.checkAnswer(c.word_taught.text),d)}}),r.a.createElement("p",null,c.display_text.substr(c.display_text.indexOf("#")+1,c.display_text.length)),r.a.createElement("button",{style:{margin:"15px 5px 15px 5px"},onClick:function(){n.submitAnswer(t,s,e,u,c.word_taught.text,c.time_fetched,n.checkAnswer(c.word_taught.text),d)}},(n.state.showAnswer,">")))}))),r.a.createElement("div",null,r.a.createElement("p",{style:{fontSize:"24px"}},c.clean_text!==c.word_taught.text&&c.word_taught.english)),n.state.showAnswer&&c.word_taught.characters.length>0&&r.a.createElement("button",{onClick:function(){return n.setState((function(e){return{showCharacterDefinitions:!e.showCharacterDefinitions}}))}},"Character Definitions"),n.state.showAnswer&&r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",flexDirectioion:"row",justifyContent:"center"}},r.a.createElement("p",null,c.word_taught.text),r.a.createElement("p",{style:{marginLeft:"5px"}},c.word_taught.pinyin))))}return r.a.createElement("div",null,$("access-token")&&o&&o.getCurrentProgress&&150===o.getCurrentProgress.words_learned?"Demo Complete":!$("access-token")&&"Please login to continue")}))}},{key:"render",value:function(){var e=this,t=this.state.user,n=t.userId,a=t.role;return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},n?this.playDashboard(n,a):r.a.createElement(_.a,{mutation:ce,onCompleted:function(t){return e._confirm(t)}},(function(e){return r.a.createElement("button",{onClick:function(){return e({variables:{user_name:"",email:"",password:"",role:"TESTER"}})}},"BEGIN")}))))}}]),n}(a.Component);function me(){var e=Object(d.a)(["\nquery getUser {\n  me {\n    _id\n    user_name\n    role\n    password\n    token\n  }\n}\n"]);return me=function(){return e},e}var pe=w()(me()),he=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(_.b,{query:pe},(function(e){var t=e.loading,n=e.error,a=e.data,i=e.refetch;if(t)return r.a.createElement("div",null,"Fetching");if(n)return r.a.createElement("div",null,"error");var l=a.me;return r.a.createElement("div",null,r.a.createElement(O,{user:l,refetchUser:i}),r.a.createElement(m.c,null,r.a.createElement(m.a,{exact:!0,path:"/",render:function(){return r.a.createElement(de,{user:l,refetchUser:i})}}),l&&"ADMIN"===l.role&&r.a.createElement(m.a,{exact:!0,path:"/author",component:B}),l&&"ADMIN"===l.role&&r.a.createElement(m.a,{exact:!0,path:"/editor",component:Y}),l&&"ADMIN"===l.role&&r.a.createElement(m.a,{exact:!0,path:"/words",component:K}),l&&"ADMIN"===l.role&&r.a.createElement(m.a,{exact:!0,path:"/wordedit",component:te}),r.a.createElement(m.a,{exact:!0,path:"/login",render:function(){return r.a.createElement(C,{user:l,refetchUser:i})}})))})))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var fe=n(7),ve=n(23),we=n(52),_e=n(51),ge=Object(we.a)({uri:"/graphql",credentials:"include"}),xe=new ve.a({link:ge,cache:new _e.a});l.a.render(r.a.createElement(I.a,null,r.a.createElement(fe.a,{client:xe},r.a.createElement(he,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[53,1,2]]]);
//# sourceMappingURL=main.78a33bd6.chunk.js.map